<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Dave Horsley and Ed Himwich">
<title>CIS hardening for FSL10</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>CIS hardening for FSL10</h1>
<div class="details">
<span id="author" class="author">Dave Horsley and Ed Himwich</span><br>
<span id="revdate">Version 1.6.0 - January 2022</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_partition_configuration">Partition Configuration</a></li>
<li><a href="#_post_installation_changes">Post-installation changes</a>
<ul class="sectlevel2">
<li><a href="#_scripted_changes">Scripted changes</a></li>
<li><a href="#_manual_changes">Manual changes</a></li>
<li><a href="#_other_policies">Other policies</a></li>
</ul>
</li>
<li><a href="#_cis_exceptions">CIS Exceptions</a>
<ul class="sectlevel2">
<li><a href="#_1_4_2_ensure_bootloader_password_is_set">1.4.2 Ensure bootloader password is set</a></li>
<li><a href="#_2_2_2_ensure_x_window_system_is_not_installed">2.2.2 Ensure X Window System is not installed</a></li>
<li><a href="#_2_2_4_ensure_cups_is_not_enabled">2.2.4 Ensure CUPS is not enabled</a></li>
<li><a href="#_2_2_11_ensure_imap_and_pop3_server_is_not_enabled">2.2.11 Ensure IMAP and POP3 server is not enabled</a></li>
<li><a href="#_3_5_firewall_configuration">3.5 Firewall Configuration</a></li>
<li><a href="#_4_2_1_4_ensure_rsyslog_is_configured_to_send_logs_to_a_remote_log_host">4.2.1.4 Ensure rsyslog is configured to send logs to a remote log host</a></li>
<li><a href="#_4_2_4_ensure_permissions_on_all_logfiles_are_configured">4.2.4 Ensure permissions on all logfiles are configured</a></li>
<li><a href="#_5_2_6_ensure_ssh_x11_forwarding_is_disabled">5.2.6 Ensure SSH X11 forwarding is disabled</a></li>
<li><a href="#_5_4_2_ensure_system_accounts_are_non_login">5.4.2 Ensure system accounts are non-login</a></li>
</ul>
</li>
<li><a href="#_cis_issues_that_need_to_be_addressed">CIS issues that need to be addressed</a>
<ul class="sectlevel2">
<li><a href="#_2_2_1_2_ensure_ntp_is_configured">2.2.1.2 Ensure ntp is configured</a></li>
<li><a href="#_2_3_4_ensure_telnet_client_is_not_installed">2.3.4 Ensure telnet client is not installed</a></li>
<li><a href="#_4_1_1_2_ensure_system_is_disabled_when_audit_logs_are_full">4.1.1.2 Ensure system is disabled when audit logs are full</a></li>
<li><a href="#_5_2_13_ensure_only_strong_ciphers_are_used">5.2.13 Ensure only strong ciphers are used</a></li>
<li><a href="#_5_2_14_ensure_only_strong_mac_algorithms_are_used">5.2.14 Ensure only strong MAC algorithms are used</a></li>
<li><a href="#_5_2_15_ensure_only_strong_key_exchange_algorithms_are_used">5.2.15 Ensure only strong Key Exchange algorithms are used</a></li>
<li><a href="#_5_2_16_ensure_ssh_idle_timeout_interval_is_configured">5.2.16 Ensure SSH Idle Timeout Interval is configured</a></li>
<li><a href="#_5_3_1_ensure_password_creation_requirements_are_configured">5.3.1 Ensure password creation requirements are configured</a></li>
<li><a href="#_5_4_1_4_ensure_inactive_password_lock_is_30_days_or_less">5.4.1.4 Ensure inactive password lock is 30 days or less</a></li>
</ul>
</li>
<li><a href="#_cis_remediation_problems">CIS Remediation problems</a>
<ul class="sectlevel2">
<li><a href="#_2_1_2_ensure_openbsd_inetd_is_not_installed">2.1.2 Ensure openbsd-inetd is not installed</a></li>
<li><a href="#_2_2_1_2_ensure_ntp_is_configured_2">2.2.1.2 Ensure ntp is configured</a></li>
<li><a href="#_2_3_4_ensure_telnet_client_is_not_installed_2">2.3.4 Ensure telnet client is not installed</a></li>
<li><a href="#_3_2_4_ensure_suspicious_packets_are_logged">3.2.4 Ensure suspicious packets are logged</a></li>
<li><a href="#_4_1_configure_system_accounting_auditd">4.1 Configure System Accounting (auditd)</a></li>
<li><a href="#_4_1_6_ensure_events_that_modify_the_systems_network_environment_are_collected">4.1.6 Ensure events that modify the system&#8217;s network environment are collected</a></li>
<li><a href="#_4_1_17_ensure_kernel_module_loading_and_unloading_is_collected">4.1.17 Ensure kernel module loading and unloading is collected</a></li>
</ul>
</li>
<li><a href="#_additional_set_up">Additional set-up</a>
<ul class="sectlevel2">
<li><a href="#_fix_ups">Fix-ups</a></li>
<li><a href="#_enabling_user_promotion_to_operprog_and_root">Enabling user promotion to oper/prog and root</a></li>
<li><a href="#_adding_auid_accounts">Adding AUID accounts</a></li>
<li><a href="#_adjust_number_of_login_failures_before_lock_out">Adjust number of login failures before lock-out</a></li>
<li><a href="#_setting_hostname_alias">Setting hostname alias</a></li>
<li><a href="#_installing_refresh_spare_usr2_with_cis_hardening">Installing refresh_spare_usr2 with CIS hardening</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These notes detail adding extra security features to Field System
Linux <em>10</em> as advised by Center for Internet Security (CIS). With the
exception of the partition configuration, all actions are to be
performed post-installation (see the <a href="installation.html">FSL10
      Installation</a> document). All tests that failed, topics that need
to be discussed, and issues with the benchmark remediations are
provided in separate sections. A final section covers additional
steps that are needed for FS operations.</p>
</div>
<div class="paragraph">
<p>This document  is based on the results for the &#8220;CIS Debian Linux 9
Benchmark v1.0.0 - Level 2 - Server&#8221;.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_partition_configuration">Partition Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During installation, be sure to create the logical volumes marked
optional during the partition section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_post_installation_changes">Post-installation changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All commands need to be run as <em>root</em>.</p>
</div>
<div class="sect2">
<h3 id="_scripted_changes">Scripted changes</h3>
<div class="paragraph">
<p>As many changes as possible are implemented by the <em>remediate</em> script.
The script is intended to be run after the &#8220;Third Stage Installation&#8221;
steps in the FSL10 instructions, before any further changes have been
made to the system (however initializing and adding other disks to the
RAID can intervene).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /root/fsl10
script ../remediate.txt
./remediate
exit</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This script should not be run more than once on a system.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The use of the <em>script</em> command causes the output to be recorded
in the specified file. This can be very helpful for understanding what
went wrong if the script fails. The script itself uses the <code>-x</code> option
to echo the commands as they are executed to make it easy to match the
output with the commands being executed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_manual_changes">Manual changes</h3>
<div class="paragraph">
<p>This section covers manual operations that are required <em>after</em> running the script.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reboot and execute:</p>
<div class="literalblock">
<div class="content">
<pre>aa-enforce /etc/apparmor.d/*</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>All the CIS remediations that can applied at this point have been
completed. The next section describes some other policies that can be
considered.</p>
</div>
</div>
<div class="sect2">
<h3 id="_other_policies">Other policies</h3>
<div class="paragraph">
<p>This section describes other policies that may be desirable. Some
are beyond the CIS benchmark.</p>
</div>
<div class="sect3">
<h4 id="_etchosts_deny">/etc/hosts.deny</h4>
<div class="paragraph">
<p>Add:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ALL:ALL</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_etchosts_allow">/etc/hosts.allow</h4>
<div class="paragraph">
<p>Add:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sshd:ALL</pre>
</div>
</div>
<div class="paragraph">
<p>It is recommended that you further restrict <em>sshd</em> to specific hosts and/or
sub-domains.</p>
</div>
</div>
<div class="sect3">
<h4 id="_password_policies">Password policies</h4>
<div class="paragraph">
<p>You may wish to set minimum password length to 12.</p>
</div>
<div class="paragraph">
<p>You may wish to set password reuse remember to 24.</p>
</div>
</div>
<div class="sect3">
<h4 id="_set_remote_log_host_andor_retention_to_a_minimum_of_one_year">Set remote log host and/or retention to a minimum of one year</h4>
<div class="paragraph">
<p>You may wish to configure a remote log host and/or set log retention
period to at least one year.</p>
</div>
<div class="paragraph">
<p>To set a remote log host, edit the <em>/etc/rsyslog.conf</em> and
<em>/etc/rsyslog.d/*.conf</em> files and add the following line (where
<em>loghost.example.com</em> is the name of your central log host).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>*.* @@loghost.example.com</pre>
</div>
</div>
<div class="paragraph">
<p>Run the following command to reload the rsyslogd configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>kill -HUP rsyslogd</pre>
</div>
</div>
<div class="paragraph">
<p>Set the retention period of system logs by editing
<em>/etc/logrotate.d/rsyslog</em>. This should be configured to store logs
for at least a minimum of a year (366 for daily 53 for weekly)..</p>
</div>
</div>
<div class="sect3">
<h4 id="_bootloader_password">Bootloader password</h4>
<div class="paragraph">
<p>You may wish to create an encrypted password with grub-mkpasswd-pbkdf2:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>grub-mkpasswd-pbkdf2
Enter password: &lt;password&gt;
Reenter password: &lt;password&gt;
Your PBKDF2 is &lt;encrypted-password&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Add the following into <em>/etc/grub.d/00_header</em> or a custom
<em>/etc/grub.d</em> configuration file:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cat &lt;&lt;EOF
set superusers="&lt;username&gt;"
password_pbkdf2 &lt;username&gt; &lt;encrypted-password&gt;
EOF</pre>
</div>
</div>
<div class="paragraph">
<p>If there is a requirement to be able to boot/reboot without entering
the password, edit <em>/etc/grub.d/10_linux</em> and add <code>--unrestricted</code> to the
line <code>CLASS=</code></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
It is strongly recommended that booting without a password
be permitted. Otherwise, if a reboot is required to continue
operations it will not be possible unless some one with the password
is available. If they aren&#8217;t available, this could lead to loss of
VLBI data and can be a safety issue.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CLASS="--class gnu-linux --class gnu --class os --unrestricted"</pre>
</div>
</div>
<div class="paragraph">
<p>Run the following commands to update the grub2 configuration and reset
the <em>grub.cfg</em> permissions:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>update-grub
chmod go-rwx /boot/grub/grub.cfg</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cis_exceptions">CIS Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section addresses the tests that failed in the CIS benchmark
after all the remediations in this document were applied.</p>
</div>
<div class="sect2">
<h3 id="_1_4_2_ensure_bootloader_password_is_set">1.4.2 Ensure bootloader password is set</h3>
<div class="paragraph">
<p>Must be set later by administrators.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_2_2_ensure_x_window_system_is_not_installed">2.2.2 Ensure X Window System is not installed</h3>
<div class="paragraph">
<p>X Window system is required for FS use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_2_4_ensure_cups_is_not_enabled">2.2.4 Ensure CUPS is not enabled</h3>
<div class="paragraph">
<p>CUPS is required for operations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_2_11_ensure_imap_and_pop3_server_is_not_enabled">2.2.11 Ensure IMAP and POP3 server is not enabled</h3>
<div class="paragraph">
<p>Exim4 is required as MTA; it never accepts incoming remote connections
(blocked at firewall).</p>
</div>
</div>
<div class="sect2">
<h3 id="_3_5_firewall_configuration">3.5 Firewall Configuration</h3>
<div class="paragraph">
<p>The firewall is configured with <em>ufw</em> instead of <em>iptables</em> and
<em>ip6tables</em>. This causes four to six issues depending on the details
of the installation, but <em>ufw</em> provides the same security as the
recommended remediations. The configuration is set to by default deny
for incoming connections, enable incoming SSH connections, and sets
logging for all connections. Setup:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>apt-get -y install ufw
ufw allow OpenSSH
ufw logging on
ufw --force enable</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_4_2_1_4_ensure_rsyslog_is_configured_to_send_logs_to_a_remote_log_host">4.2.1.4 Ensure rsyslog is configured to send logs to a remote log host</h3>
<div class="paragraph">
<p>A remote log server must be configured by system administrators later.</p>
</div>
</div>
<div class="sect2">
<h3 id="_4_2_4_ensure_permissions_on_all_logfiles_are_configured">4.2.4 Ensure permissions on all logfiles are configured</h3>
<div class="paragraph">
<p>All files except <em>/var/log/wtmp</em> have the requested permissions. That
file changes on a reboot to <code>rw-rw-r--</code>, owned by <code>root.wtmp</code>. No
sensitive information is stored in the file and making it readable for
others allows commands like <em>last</em> and <em>who</em> to work.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_6_ensure_ssh_x11_forwarding_is_disabled">5.2.6 Ensure SSH X11 forwarding is disabled</h3>
<div class="paragraph">
<p>We require <em>ssh</em> X11 forwarding for use with FS for remote operations
and testing.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_4_2_ensure_system_accounts_are_non_login">5.4.2 Ensure system accounts are non-login</h3>
<div class="paragraph">
<p>System accounts (i.e., accounts with <code>UID</code> less than <code>1000</code>) <em>oper</em>
and <em>prog</em> are needed for compatibility with the wider VLBI community
and are only used as service accounts from AUID accounts. They require
a valid shell, but direct local login and <em>ssh</em> login (including with
    keys) are disabled for these two accounts. Note that <em>oper</em> and
<em>prog</em> have no password expiration (they has no passwords) or
inactivity time-out, like other system accounts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cis_issues_that_need_to_be_addressed">CIS issues that need to be addressed</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section lists further topics related to the benchmark that should be
discussed.</p>
</div>
<div class="sect2">
<h3 id="_2_2_1_2_ensure_ntp_is_configured">2.2.1.2 Ensure ntp is configured</h3>
<div class="paragraph">
<p>Need FS NTP configuration. That is more secure than the benchmark since
it uses <code>ignore</code> by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_3_4_ensure_telnet_client_is_not_installed">2.3.4 Ensure telnet client is not installed</h3>
<div class="paragraph">
<p>Would prefer to keep the <em>telnet</em> client, it is useful for debugging
ASCII device protocol devices, which we have.  The security weakness
is <em>telnetd</em>, which is not installed, nor does the benchmark test
for it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_4_1_1_2_ensure_system_is_disabled_when_audit_logs_are_full">4.1.1.2 Ensure system is disabled when audit logs are full</h3>
<div class="paragraph">
<p>This may not be appropriate for an operational system.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_13_ensure_only_strong_ciphers_are_used">5.2.13 Ensure only strong ciphers are used</h3>
<div class="paragraph">
<p>What ciphers should we use?</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_14_ensure_only_strong_mac_algorithms_are_used">5.2.14 Ensure only strong MAC algorithms are used</h3>
<div class="paragraph">
<p>What MAC algorithms should we use?</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_15_ensure_only_strong_key_exchange_algorithms_are_used">5.2.15 Ensure only strong Key Exchange algorithms are used</h3>
<div class="paragraph">
<p>What Key Exchange algorithms should we use?</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_16_ensure_ssh_idle_timeout_interval_is_configured">5.2.16 Ensure SSH Idle Timeout Interval is configured</h3>
<div class="paragraph">
<p>Five minutes is too short.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_3_1_ensure_password_creation_requirements_are_configured">5.3.1 Ensure password creation requirements are configured</h3>
<div class="paragraph">
<p>Should we use the NASA 12 character minimum?</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_4_1_4_ensure_inactive_password_lock_is_30_days_or_less">5.4.1.4 Ensure inactive password lock is 30 days or less</h3>
<div class="paragraph">
<p>This is too short for developers/troubleshooters</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cis_remediation_problems">CIS Remediation problems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section details problems with the recommended remediations.</p>
</div>
<div class="sect2">
<h3 id="_2_1_2_ensure_openbsd_inetd_is_not_installed">2.1.2 Ensure openbsd-inetd is not installed</h3>
<div class="paragraph">
<p>Remediation solves problem, but does not make the test pass. To do the
latter required <code>purge</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_2_1_2_ensure_ntp_is_configured_2">2.2.1.2 Ensure ntp is configured</h3>
<div class="paragraph">
<p>Remediation makes it less secure. A default policy of <code>ignore</code> is better.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_3_4_ensure_telnet_client_is_not_installed_2">2.3.4 Ensure telnet client is not installed</h3>
<div class="paragraph">
<p>The remediation does not make the test pass, that required <code>purge</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_3_2_4_ensure_suspicious_packets_are_logged">3.2.4 Ensure suspicious packets are logged</h3>
<div class="paragraph">
<p>The remediation lines added in <em>/etc/sysctl.d/*</em> are not respected at
boot (unlike all others). To overcome this, the following lines are
used in a new systemd service <code>CISfix</code> at boot.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sysctl -w net.ipv4.conf.all.log_martians=1
sysctl -w net.ipv4.conf.default.log_martians=1
sysctl -w net.ipv4.route.flush=1</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_4_1_configure_system_accounting_auditd">4.1 Configure System Accounting (auditd)</h3>
<div class="paragraph">
<p>Many of the remedations are described in terms of the contents of
<em>/etc/audit/audit.rules</em>. However, the contents of that file are
auto-generated at boot from the files in <em>/etc/audit/rules.d</em>, which
is where these remediations must go.</p>
</div>
</div>
<div class="sect2">
<h3 id="_4_1_6_ensure_events_that_modify_the_systems_network_environment_are_collected">4.1.6 Ensure events that modify the system&#8217;s network environment are collected</h3>
<div class="paragraph">
<p>64-bit remediation had <code>b64</code> and <code>b32</code> rules concatenated on one line.</p>
</div>
</div>
<div class="sect2">
<h3 id="_4_1_17_ensure_kernel_module_loading_and_unloading_is_collected">4.1.17 Ensure kernel module loading and unloading is collected</h3>
<div class="paragraph">
<p>64-bit remediation was missing <code>b32</code> rule.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_set_up">Additional set-up</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After the CIS hardening is completed, some additional set-up is needed.</p>
</div>
<div class="sect2">
<h3 id="_fix_ups">Fix-ups</h3>
<div class="paragraph">
<p>There are three issues that need to be corrected after the CIS hardening.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The AIDE package used in CIS hardening adds a line to <em>/etc/crontab</em>
to run <em>aide.wrapper</em>. Unfortunately at this time, the line inserted is
incorrectly formatted, missing the &#8220;user&#8221; field, for Debian systems.
This causes the <em>cron</em> daemon to ignore the file, thereby breaking
basic <em>cron</em> functionality. This can be fixed by adding <em>root</em> as the
user in a new field after the fifth field on the <em>aide.wrapper</em> line
and then running:</p>
<div class="literalblock">
<div class="content">
<pre>systemctl restart cron</pre>
</div>
</div>
</li>
<li>
<p>The CIS hardening configuration of PAM causes uses of <em>sudo</em> that
require a password to increment the failure count when a correct
password is accepted, leading to eventual lock-out of the user using
<em>sudo</em> when the <code>deny</code> lock-out failure count is reached.  To make sure the
<code>tally2</code> failure count is reset after a successful <em>sudo</em> that
required a password, add to:</p>
<div class="listingblock">
<div class="title">/etc/pam.d/common-account</div>
<div class="content">
<pre class="highlight"><code>account required pam_tally2.so</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To reset a locked-out user after CIS hardening, use <code><strong>/sbin/pam_tally2 -u <em>user</em> --reset</strong></code>
where <code><strong><em>user</em></strong></code> is the user account. Leave off the <code>--reset</code> to see what the current tally is.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Using the <code>noexec</code> option for <em>/tmp</em> causes a problem for the
package management system. The <em>dpkg-preconfigure</em> program places and
executes scripts on <em>/tmp</em> as part of package installation. The
<code>noexec</code> option prevents the execution of the scripts. To work around
this issue, you can exeucte:</p>
<div class="literalblock">
<div class="content">
<pre>cd /root/fsl10/
./root_tmp</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>root_tmp</em> script will do three things:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Create a one time service at boot to clean the <em>/root/tmp</em> directory</p>
</li>
<li>
<p>Set <em>dpkg-preconfigure</em> to use <em>/root/tmp</em> for temporary files</p>
</li>
<li>
<p>Create an initial <em>/root/tmp</em> directory</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There may be other issues with using the <code>noexec</code> option for <em>/tmp</em>,
but we don&#8217;t have any specifics at this time.</p>
</div>
</li>
<li>
<p>Sometimes the firewall (<em>ufw</em>) does not work properly after rebooting.
This has been noticed for remote access to <em>gromet</em> for met. data on
port 50001. There are no other known issues. An apparent fix for this
is to disable and re-enable the firewall. If you have this problem and
the same solution works, a one-time service at start-up can be created
to perform this action:</p>
<div class="literalblock">
<div class="content">
<pre>cd /root/fsl10
./create_ufw_re-enable</pre>
</div>
</div>
<div class="paragraph">
<p>The new service will run at the next reboot. It is configured to run
<em>after</em> <em>ufw</em> has been started.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_enabling_user_promotion_to_operprog_and_root">Enabling user promotion to oper/prog and root</h3>
<div class="paragraph">
<p>The model of FSL assumes <em>oper</em> and <em>prog</em> accounts will be used for
operations and programming respectively. However, some organizations may
have security and auditing restrictions that mean operators must
log-in using their own account (possibly named with their Agency User ID,
    AUID).  As the Field System currently operates, users will then
need to switch to the <em>oper</em> or <em>prog</em> account after login. Likewise,
     if a user is allowed to elevate to <em>root</em>, they will need to do
     so after log-in to their own account. This sub-section covers how to
     enable this capability. The next sub-section <a href="#_adding_auid_accounts">Adding AUID accounts</a> covers how to add an
     AUID account. The method described here, and in the next sub-section,
     uses <em>dhorsley</em> as an example user.</p>
</div>
<div class="paragraph">
<p>For <em>oper</em> and <em>prog</em>, we suggest creating two groups that can <em>sudo</em>
to the accounts.</p>
</div>
<div class="paragraph">
<p>run <em>visudo</em> then add at end:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>%operators      ALL=(oper) NOPASSWD: ALL
%programmers    ALL=(prog) NOPASSWD: ALL
%programmers    ALL=(oper) NOPASSWD: ALL</pre>
</div>
</div>
<div class="paragraph">
<p>To allow <em>operators</em> to use <em>refresh_secondary</em>, <em>shutdown</em>, and <em>reboot</em>, add (respectively):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>%operators      ALL=(ALL) /usr/local/sbin/refresh_secondary
%operators      ALL=(ALL) /sbin/shutdown
%operators      ALL=(ALL) /sbin/reboot</pre>
</div>
</div>
<div class="paragraph">
<p>To use these commands the <em>operators</em> will need to enter (respectively) from their AUID accounts:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo refresh_secondary
sudo shutdown
sudo reboot</pre>
</div>
</div>
<div class="paragraph">
<p>A password will be required. Trailing options can be used with the commands, as appropriate.</p>
</div>
<div class="paragraph">
<p>If the  user can elevate to <em>root</em>, also add:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dhorsley       ALL=(root) ALL</pre>
</div>
</div>
<div class="paragraph">
<p>Create the groups if they don&#8217;t exist:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>addgroup operators
addgroup programmers</pre>
</div>
</div>
<div class="paragraph">
<p>If they don&#8217;t already, make sure <em>oper</em> and <em>prog</em> have usable shells:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>chsh -s /bin/bash oper
chsh -s /bin/bash prog</pre>
</div>
</div>
<div class="paragraph">
<p>If the accounts haven&#8217;t been disabled for login already, do so:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>usermod -L oper
usermod -L prog</pre>
</div>
</div>
<div class="paragraph">
<p>To prevent connecting with <em>ssh</em> using a key, create (or add <em>oper</em>
and <em>prog</em> to an existing) <code>DenyUsers</code> line in <em>/etc/ssh/sshd_config</em>:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you used the CIS <em>remediate</em> script, you should comment out
the line: <code>DenyGroup rtx</code> as well.
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>DenyUsers oper prog</pre>
</div>
</div>
<div class="paragraph">
<p>And restart <em>sshd</em> with:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>systemctl restart sshd</pre>
</div>
</div>
<div class="paragraph">
<p>Authorized users can then switch to <em>oper</em> with (similarly for
<em>prog</em> and <em>root</em>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo -i -u oper</pre>
</div>
</div>
<div class="paragraph">
<p>No password will be required (except for <em>root</em>).</p>
</div>
<div class="paragraph">
<p>To ensure X authorization works do the following (this example is for
user <em>oper</em> and  works analogously for <em>prog</em> and <em>root</em>, but see the
note at the end of step (1) about <em>root</em>'s Xresources:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add this to the following file:</p>
<div class="listingblock">
<div class="title">~/.profile</div>
<div class="content">
<pre class="highlight"><code>if ! [ -z "$XCOOKIE" ]; then
   xauth add $XCOOKIE
fi
if echo $DISPLAY |grep -q localhost; then
#   ssh from remote host with X display
    xrdb -merge ~/.Xresources
else
    if ! [ -z $DISPLAY ]; then
      if xhost|grep -q 'SI:localuser:oper'; then
#       local X display
        xrdb -merge ~/.Xresources
      fi
    else
#     text terminal, do nothing
      :
    fi
fi</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will also set the Xresources to those of <em>oper</em>. (For <em>root</em>
    only the first clause would be used since Xresources would not be
    set.)</p>
</div>
</li>
<li>
<p>Create the following file</p>
<div class="listingblock">
<div class="title">/usr/local/bin/oper_account</div>
<div class="content">
<pre class="highlight"><code>#!/bin/bash
set -e
if echo $DISPLAY |grep -q localhost; then
 sudo -u oper XCOOKIE="$(xauth list $DISPLAY)" -i
else
 if ! xhost|grep -q 'SI:localuser:oper'; then
   xhost +SI:localuser:oper &gt;/dev/null
 fi
 sudo -u oper -i
fi</code></pre>
</div>
</div>
</li>
<li>
<p>Execute:</p>
<div class="literalblock">
<div class="content">
<pre>chmod a+rx /usr/local/bin/oper_account</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The three numbered steps above can be executed for <em>oper</em>, <em>prog</em>, and <em>root</em>
with:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>~/fsl10/AUID/install_AUID</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_auid_accounts">Adding AUID accounts</h3>
<div class="paragraph">
<p>This sub-section describes how to add AUID accounts to be used with the
ability to promote to <em>oper</em>, <em>prog</em>, and <em>root</em> as described in the
previous sub-section. As in the previous sub-section, the following method
uses <em>dhorsley</em> as an example user.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add any needed user accounts as appropriate:</p>
<div class="literalblock">
<div class="content">
<pre>adduser dhorsley --home /usr2/dhorsley</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If you are configuring a spare computer, you will need to
make sure the <code>UID</code> and <code>GID</code> for each user with a home directory on
<em>/usr2</em> is the same on both computers for the system-to-system backup
of <em>/usr2</em> to work properly.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For normal operations, AUID users' home directories should be on
<em>/usr2</em>. However, for some maintenance accounts, it may make sense to
have the home directory some where else, typically on <em>/home</em>. In that
case, use this command instead:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>adduser dhorsley</pre>
</div>
</div>
<div class="paragraph">
<p>The final step of this section will need to be adjusted accordingly.</p>
</div>
<div class="paragraph">
<p>The <code>UID</code> and <code>GID</code> of the account should still be kept in agreement
between the two computers.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Add each user to these groups as appropriate, e.g.:</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This step assumes that the <em>operators</em> and <em>programmers</em> groups have been created as described in the previous sub-section <a href="#_enabling_user_promotion_to_operprog_and_root">Enabling user promotion to oper/prog and root</a>.
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>adduser dhorsley operators</pre>
</div>
</div>
<div class="paragraph">
<p>and/or:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>adduser dhorsley programmers</pre>
</div>
</div>
</li>
<li>
<p>If the user should be able to manage printers, use:</p>
<div class="literalblock">
<div class="content">
<pre>adduser dhorsley lpadmin</pre>
</div>
</div>
</li>
<li>
<p>If the account will be used by an operator and/or programmer, the X11
environment needs to be set-up. The following command will move an
existing <em>/usr2/dhorsley</em> to <em>/usr2/dhorsley.FSCOPY</em> and create a new
<em>/usr2/dhorsley</em> with a useful skeleton for use with the FS (you will
    be prompted for the account name):</p>
<div class="literalblock">
<div class="content">
<pre>/usr2/fs/misc/auid_update</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If the user&#8217;s home directory is not on <em>/usr2</em>, but is for example on
<em>/home</em>, the following commands should be used instead:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /home
mv dhorsley dhorsley.FSCOPY
cd /usr2/fs/st.default/auid
find . -print|cpio -pmdu /home/dhorsley
chown -R dhorsley.dhorsley /home/dhorsley</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_adjust_number_of_login_failures_before_lock_out">Adjust number of login failures before lock-out</h3>
<div class="paragraph">
<p>The number of login failures before lock-out can cause a problem if it
is set too low.  The main issue is for an operator working at odd
hours, alone, at a remote location, who is dealng with multiple
issue, which might include: power failures, equipment problems, and
logistical issues. It can be a chaotic situation. Typing long and
complicated passwors in the heat of battle, particularly if they vary
between machines, can be error-prone. Being locked-out will make the
situation more difficult and increase the amount of data that will be
lost.</p>
</div>
<div class="paragraph">
<p>If you find the number of login failures before lock-out too small,
you can increase it by increasing the value of the <code>deny</code> parameter
(<code>5</code> in the example below, other typical parameters are omitted and
should not be changed) in:</p>
</div>
<div class="listingblock">
<div class="title">/etc/pam.d/common-auth</div>
<div class="content">
<pre class="highlight"><code>auth required pam_tally2.so deny=5</code></pre>
</div>
</div>
<div class="paragraph">
<p>Small integer values (20 or less) should not be a signficant risk with
long and complicated passwords and a lock-out of several minutes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_setting_hostname_alias">Setting hostname alias</h3>
<div class="paragraph">
<p>These steps set a more user friendly alias for the computers of the
form <em>fs1-&lt;xx&gt;</em> and <em>fs2-&lt;xx&gt;</em> where <em>&lt;xx&gt;</em> is the station&#8217;s two letter
code.  This provides a compact alias for local usage, even for sites
with more than one system, and makes the system identifiable for
remote users in a systematic way. These steps should be executed for
both the <em>operational</em> and <em>spare</em> computers.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit <em>/etc/hosts</em> and add the new aliases to the appropriate lines.</p>
<div class="paragraph">
<p>If you have two computers, add the aliases for both to the file on each computer.</p>
</div>
</li>
<li>
<p>Create a file <em>/etc/hostname_alias</em> that contains the new alias.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Execute</p>
<div class="literalblock">
<div class="content">
<pre>cd /etc
cp hostname hostname_alias</pre>
</div>
</div>
</li>
<li>
<p>Edit the new file and change the contents to the new alias.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Change the system&#8217;s mailname</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To allow mail to <em>mailman</em> mail lists to work, you may need to
make a use a fake FQDN name, perhaps by appending <em>.net</em> to your
alias, for use in <em>/etc/mailname</em> and
<em>/etc/exim4/update-exim4.conf.conf</em>. The two files should be
consistent.
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Edit the file <em>/etc/mailname</em> and change its contents to the new
name, without a domain name unless that is required by remote mail
hosts or mail lists. If so,
<a href="installation.html#_generate_fqdn_in_helo_for_outgoing_mail">Generate FQDN in HELO for outgoing mail</a>
in the FSL10 Installation document may also be helpful.</p>
</li>
<li>
<p>Edit <em>/etc/exim4/update-exim4.conf.conf</em>, change the value of <code>hostnames=</code> to the new alias</p>
</li>
<li>
<p>Execute</p>
<div class="literalblock">
<div class="content">
<pre>update-exim4.conf
systemctl restart exim4</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>For the <em>spare</em> computer only:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Update <em>/usr/local/sbin/refresh_spare_usr2</em> to use the new alias of the <em>operational</em> computer in the <em>ssh</em> line.</p>
</li>
<li>
<p>You will need to update the new alias for the <em>operational</em>
computer to be recognized as a known host to the <em>root</em> account on the
<em>spare</em> computer. You can do that by using <em>ssh</em> to
<code>spare@operational</code> where <code>operational</code> is new alias for the
<em>operational</em> computer. The command will give you guidance for which
lines need to be deleted in <em>/root/.ssh/known_hosts</em>. After deleting
those lines, reconnect using the same <em>ssh</em> command and answer <code><strong>yes</strong></code>
to confirm connecting. Finally, logout of the <em>spare</em> account on
<em>operational</em> computer.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Use the new alias in the user prompts and <em>xterm</em> titles for <em>oper</em>, <em>prog</em>, and all non-system-administrator AUID accounts. In the
<code>.bashrc</code> file for each user to be changed:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Before the <code>if</code> block that sets <code>PS1</code> add:</p>
<div class="literalblock">
<div class="content">
<pre>hostalias_file=/etc/hostname_alias
if [[ -f "$hostalias_file" ]]; then
    hostalias=$(cat $hostalias_file)
else
    hostalias=$(hostname)
fi</pre>
</div>
</div>
</li>
<li>
<p>In the two statements setting <code>PS1</code> in the <code>if</code> block, change the use of <code>\h</code> to <code>$hostalias</code>.</p>
</li>
<li>
<p>In the statement setting <code>PS1</code> in the <code>case</code> block that sets the <em>xterm</em> window title, change the use of <code>\h</code> to <code>$hostalias</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_installing_refresh_spare_usr2_with_cis_hardening">Installing refresh_spare_usr2 with CIS hardening</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This subsection follows the FS manual font conventions.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Read the
<a href="raid.html#_refresh_spare_usr2">refresh_spare_usr2</a> section of the
<a href="raid.html">RAID Notes for FSL10</a> document for important information
on the <em>refresh_spare_usr2</em> script.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This subsection describes the steps needed to enable use of the
<em>refresh_spare_usr2</em> script with CIS hardening. All steps must be
performed as <em>root</em> on the specified system. You should read all of
each step or sub-step before following it.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the <em>operational</em> system:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Create <em>spare</em> account. Execute:</p>
<div class="listingblock">
<div class="content">
<pre>addgroup spare --gid 2000
adduser spare --uid 2000 --gid 2000</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The user&#8217;s home directory is on <em>/home</em> (by default), not
<em>/usr2</em>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The UID and GID values of <code>2000</code> are chosen to make it easier to
keep the values in sync for users on both systems. In other words, it
is not necessary to worry about jumping over a low value on the
<em>spare</em> system when values are assigned sequentially, as is the
default. If you think you might have more than 1000 users or groups,
you might want to increase the values for the <em>spare</em> account and
group.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>On the <em>spare</em> system.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Install <em>refresh_spare_usr2</em>. Execute:</p>
<div class="literalblock">
<div class="content">
<pre>cd /usr/local/sbin
cp -a /root/fsl10/RAID/refresh_spare_usr2 refresh_spare_usr2
chown root.root refresh_spare_usr2
chmod a+r,u+wx,go-wx refresh_spare_usr2</pre>
</div>
</div>
</li>
<li>
<p>Customize <em>refresh_spare_usr2</em>, following the directions in the
comments in the script:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Comment-out the lines (add leading <code>#</code>s):</p>
<div class="literalblock">
<div class="content">
<pre>echo "This script must be customized before use.  See script for details."
exit 1</pre>
</div>
</div>
</li>
<li>
<p>Change the <em>operational</em> in the line:</p>
<div class="literalblock">
<div class="content">
<pre>remote_node=operational</pre>
</div>
</div>
<div class="paragraph">
<p>to the alias (preferred), FQDN, or IP address of your <em>operational</em>
system.</p>
</div>
</li>
<li>
<p>Uncomment the line for CIS hardened systems. The commented out
form is:</p>
<div class="literalblock">
<div class="content">
<pre>#remote_user=spare</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Create and copy a key for <em>root</em>. Execute:</p>
<div class="listingblock">
<div class="content">
<pre>ssh-keygen
ssh-copy-id spare@<em>operational</em></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>operational</em></code> is the alias, name, or IP of your <em>operational</em>
system.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If <em>root</em> already has a key, you only need the second command
above to copy it to the <em>spare</em> account:
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
It is recommended to not set a passphrase.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Enable running the script with <em>sudo</em>. Use <em>visudo</em> to add:</p>
<div class="literalblock">
<div class="content">
<pre>%operators         ALL=(ALL) /usr/local/sbin/refresh_spare_usr2</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It could be setup for a specific user (but not <em>oper</em> or <em>prog</em>
in a CIS hardened system) by replacing <code>%operators</code> with the user
account name.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>On the <em>operational</em> system:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Install the <em>rrsync</em> script. Execute:</p>
<div class="literalblock">
<div class="content">
<pre>gunzip -c /usr/share/doc/rsync/scripts/rrsync.gz &gt;/usr/local/bin/rrsync
ln -s /usr/local/bin/rrsync /usr/bin/rrsync
chmod u+x,go-x /usr/local/bin/rrsync</pre>
</div>
</div>
</li>
<li>
<p>Set the <em>spare</em> account to only allow a <em>forced command</em> with <em>ssh</em>
by replacing the <code>ssh-rsa</code> at the start of the first (and only) line of
<em>~spare/.ssh/authorized_keys</em> line with:</p>
<div class="paragraph">
<p><code>command="sudo --preserve-env rrsync -ro /usr2" ssh-rsa</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If your <em>spare</em> system is registered with DNS, you can provide
some additional security by adding <code>from="<em>node</em>" </code> &#160;(note
the trailing space) at the start of the line, where <code><em>node</em></code> is the
FQDN or IP address of the <em>spare</em> system.  It may be necessary to
provide the FQDN, IP address, and/or alias of the <em>spare</em> system in a
comma separated list in place of  <code><em>node</em></code> to get reliable
operation.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Enable the <em>spare</em> account to run <em>rrsync</em> with <em>sudo</em> without a
password and passing environment variables. Use <em>visudo</em> to add:</p>
<div class="literalblock">
<div class="content">
<pre>spare          ALL=(ALL) NOPASSWD:SETENV: /usr/bin/rrsync</pre>
</div>
</div>
</li>
<li>
<p>Lock-out the <em>spare</em> account from normal login (but it must have a
shell). This will disable password login, but not <em>ssh</em> login with
keys, for this account. Execute:</p>
<div class="listingblock">
<div class="content">
<pre>usermod -L spare</pre>
</div>
</div>
</li>
<li>
<p>Disable password aging and inactivity time-out for the <em>spare</em>
account. Execute:</p>
<div class="listingblock">
<div class="content">
<pre>chage -I -1 -M 99999 spare</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-07-28 16:50:35 -0400
</div>
</div>
</body>
</html>